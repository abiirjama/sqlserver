/*
Module 8 Challenge: SQL Statements
*/

/*
Instructions:
For this challenge, we'll be retrieving, sorting, and 
filtering data from the Northwind Database. 
We'll also insert records, update, and delete records.


Use the Northwind database for this assignment. Use the
instructions in the comments to write the SQL statements
for this assignment.
 
Run and test your SQL code using the sqlcmd command in the Terminal.
Here's an example: 
sqlcmd -S localhost -U sa -P P@ssw0rd -d Northwind -Q "SELECT * FROM Customers;"
*/


USE Northwind;

-- 1. Retrieve a list of products: name, price, stock

SELECT ProductName, UnitPrice, UnitsInStock
FROM Products;

-- 2. List products where UnitsInStock = 0
SELECT ProductName, UnitsInStock
FROM Products
WHERE UnitsInStock = 0;

-- 3. List product name and price, sorted smallest first
SELECT ProductName, UnitPrice
FROM Products
ORDER BY UnitPrice ASC;


-- 4. List all products with "Sir Rodney's" in the name
SELECT ProductName
FROM Products
WHERE ProductName LIKE '%Sir Rodney''s%';


-- 5. Product names and IDs for SupplierID = 20, ordered by name
SELECT ProductID, ProductName
FROM Products
WHERE SupplierID = 20
ORDER BY ProductName;

-- 6. Product ID and name for products with zero units on order
SELECT ProductID, ProductName
FROM Products
WHERE UnitsOnOrder = 0
ORDER BY ProductID;

-- 7. Orders for employee Janet Leverling, showing orderID,
--    customer company name, and employee full name
SELECT o.OrderID,
       c.CompanyName AS CustomerCompany,
       (e.FirstName + ' ' + e.LastName) AS EmployeeName
FROM Orders AS o
JOIN Customers AS c ON o.CustomerID = c.CustomerID
JOIN Employees AS e ON o.EmployeeID = e.EmployeeID
WHERE e.FirstName = 'Janet' AND e.LastName = 'Leverling';

-- 8. Insert a new product (your favorite food)
 
INSERT INTO Products (ProductName, UnitPrice, SupplierID, CategoryID)
VALUES ('Pizza', 4.55, 26, 5);


-- 9. Display the new record you added for your favorite food

SELECT * 
FROM Products
WHERE ProductName = 'Pizza';

-- 10. Insert a new supplier record
 
 INSERT INTO Suppliers (CompanyName, ContactName, ContactTitle, Address, City)
VALUES ('Minneapolis College', 'Abiir Jama', 'Manager', '123 Sesame Street', 'Saint Paul');


-- 11. Display the supplier you just inserted
SELECT * 
FROM Suppliers
WHERE SupplierID = 30;

-- 12. Update your favorite foodâ€™s price from 4.55 to 9.99

UPDATE Products
SET UnitPrice = 9.99
WHERE ProductName = 'Pizza';

-- 13. Insert a new category record (auto CategoryID)

INSERT INTO Categories (CategoryName, Description)
VALUES ('Ice Cream', 'Frosty desserts');


-- 14. Delete the Ice Cream record from the Categories table
DELETE FROM Categories 
Where CategoryName='Ice Cream';





	
 
